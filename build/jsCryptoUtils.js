var CryptoConsole={LOG_LEVEL_DEBUG:0,LOG_LEVEL_INFO:1,LOG_LEVEL_WARN:2,LOG_LEVEL_ERROR:3,BASE_BIN:2,BASE_HEX:16,BASE_DEC:10,log:function(input,logLevel){if(typeof logLevel==="undefined")var logLevel=this.LOG_LEVEL_DEBUG;this._consoleLog(input,logLevel)},info:function(input){this._consoleLog(input,this.LOG_LEVEL_INFO)},toBinaryString:function(input){return this.toBaseX(input,this.BASE_BIN)},toHexString:function(input){return this.toBaseX(input,this.BASE_HEX)},toBaseX:function(input,base){if(typeof base===
"undefined")var base=this.BASE_BIN;var input=parseInt(input,this.BASE_DEC);var inputAsBaseX=input.toString(base);return inputAsBaseX},logArrayAsBin:function(arrayInput,description){var outputArray=[];for(var key in arrayInput){var input=arrayInput[key];var inputAsBin=this.toBinaryString(input);outputArray[key]=inputAsBin}this.logArray(outputArray,description)},logArray:function(arrayInput,description){var outputString=description+" ";for(var key in arrayInput){var input=arrayInput[key];outputString+=
" "+input}this.log(outputString)},_consoleLog:function(input,logLevel){if(this._isConsoleEnabled()&&this._isDebugEnabled()){if(typeof input==="object")logLevel=this.LOG_LEVEL_INFO;switch(logLevel){case this.LOG_LEVEL_INFO:console.info(input);break;case this.LOG_LEVEL_WARN:console.warn(input);break;case this.LOG_LEVEL_ERROR:console.error(input);break;default:case this.LOG_LEVEL_DEBUG:console.debug(input);break}}},_isConsoleEnabled:function(){var consoleEnabled="console"in window&&"log"in window.console;
return consoleEnabled},_isDebugEnabled:function(){return this._enabled},enableDebug:function(){this._enabled=true},disableDebug:function(){this._enabled=false}};
function Algorithm(){this.ABSTRACT_METHOD_MESSAGE="Method not implemented";this.onBeforeIteration=null;this.onAfterIteration=null;this.encodeBlocksSize=1;this.decodeBlocksSize=1;this.setOnBeforeIteration=function(callback){this.onBeforeIteration=callback};this.setOnAfterIteration=function(callback){this.onAfterIteration=callback};this.sendCallback=function(callback){if(typeof callback!=="undefined"&&typeof callback==="function")callback()}}
Algorithm.prototype.encode=function(){throw new Error(this.ABSTRACT_METHOD_MESSAGE);};Algorithm.prototype.decode=function(){throw new Error(this.ABSTRACT_METHOD_MESSAGE);};
var CryptoUtils={FIX_STRING_SUFFIX:" ",_addExtraChars:function(str,numExtraChars){for(var i=0;i<numExtraChars;i++)str+=this.FIX_STRING_SUFFIX;return str},fixStringLength:function(str,blocksSize){var output="";if(typeof str==="string"){output=str;var strLen=str.length;var mod=strLen%blocksSize;var div=Math.floor(strLen/blocksSize);if(mod!==0){var extraChars=blocksSize*(div+1)-strLen;output=this._addExtraChars(str,extraChars)}}return output},trim:function(str){var str=str.replace(/^\s\s*/,""),ws=/\s/,
i=str.length;while(ws.test(str.charAt(--i)));return str.slice(0,i+1)},reverse:function(array){reversed=[];for(var i=array.length;i--;)reversed.push(array[i]);return reversed},toBytes:function(num,reverse){var bytes=[];var chr=String.fromCharCode;do{bytes.push(chr(num&255));num=Math.floor(num/256)}while(num);return(reverse?this.reverse(bytes):bytes).join("")},toNumber:function(str,reverse){var number=0;var length=str.length;if(reverse)for(var i=0;i<length;i++)number=number<<8|255&str.charCodeAt(i);
else for(var i=length;i>=0;i--)number=number<<8|255&str.charCodeAt(i);return number},toHex:function(str){var array=[];var length=str.length;for(i=0;i<length;i++)array[i]=str.charCodeAt(i).toString(16).toUpperCase();return array}};
var htmlGenerator={WRITE_MODE_OVERWRITE:1,WRITE_MODE_APPEND:2,WRITE_MODE_PREPEND:3,INTERNAL_SEPARATOR:" ",TAG_BEGIN:"<",TAG_END:">",TAG_CLOSING:"/",ATTR_ID:"id",TAG_DIV:"div",TAG_TEXTAREA:"textarea",TAG_OPTION:"option",TAG_SELECT:"select",generateSelect:function(selectId,options,extraAttributes,firstElement){var html=this.genericTag(this.TAG_SELECT,selectId,extraAttributes);var inFirstElement=true;for(var optionPos in options){if(typeof firstElement!=="undefined"&&inFirstElement){html+=this.genericTag(this.TAG_OPTION,
"",[["value",firstElement[0]]]);html+=firstElement[1];html+=this.genericClosingTag(this.TAG_OPTION);inFirstElement=false}html+=this.genericTag(this.TAG_OPTION,"",[["value",optionPos]]);html+=optionPos;html+=this.genericClosingTag(this.TAG_OPTION)}html+=this.genericClosingTag(this.TAG_SELECT);return html},generateTextarea:function(textareaId,extraAttributes){var html=this.genericTag(this.TAG_TEXTAREA,textareaId,extraAttributes);html+=this.genericClosingTag(this.TAG_TEXTAREA);return html},generateDiv:function(divId,
content){var html=this.genericTag(this.TAG_DIV,divId);if(typeof content!=="undefined")html+=content;html+=this.genericClosingTag(this.TAG_DIV);return html},genericTag:function(tagName,tagId,extraAttributes){var html="";if(typeof tagName!=="undefined"){html=this.TAG_BEGIN+tagName+this.INTERNAL_SEPARATOR;if(typeof tagId!=="undefined")html+=this.ATTR_ID+'="'+tagId+'"'+this.INTERNAL_SEPARATOR;if(typeof extraAttributes!=="undefined"){var numExtraAttributes=extraAttributes.length;for(var i=0;i<numExtraAttributes;i++){var attributes=
extraAttributes[i];html+=attributes[0]+'="'+attributes[1]+'"'+this.INTERNAL_SEPARATOR}}html+=this.TAG_END}return html},genericClosingTag:function(tagName){var html="";if(typeof tagName!=="undefined")html+=this.TAG_BEGIN+this.TAG_CLOSING+tagName+this.TAG_END;return html},inject:function(targetId,html,writeMode){if(typeof writeMode==="undefined")var writeMode=this.WRITE_MODE_OVERWRITE;if(typeof targetId!=="undefined"){var element=document.getElementById(targetId);if(element!==null)switch(writeMode){case this.WRITE_MODE_OVERWRITE:element.innerHTML=
html;break;case this.WRITE_MODE_APPEND:element.innerHTML+=html;break;case this.WRITE_MODE_PREPEND:element.innerHTML=html+element.innerHTML;break}}}};
var StringBlocksIterator=function(){var _str=null;var _blocksSize=0;var _pos=0;var _len=0;return{init:function(str,blocksSize){_str=str;_blocksSize=blocksSize;_pos=0;_len=_str.length},reset:function(){_pos=0},current:function(){var output=null;if(this._validPos())output=_str.substr(_pos,_blocksSize);return output},next:function(){var output=null;if(this._hasNext()){_pos+=_blocksSize;output=this.current()}else _pos=-1;return output},prev:function(){var output=null;if(this._hasPrev()){_pos-=_blocksSize;
output=this.current()}else _pos=-1;return output},_validPos:function(){return _pos>=0},_hasNext:function(){var hasNext=false;if(this._validPos())hasNext=_pos+_blocksSize<=_len;return hasNext},_hasPrev:function(){var hasPrev=false;if(this._validPos())hasPrev=_pos-_blocksSize>0;return hasPrev}}};
function Base64(){Algorithm.call();this.base64Alpha="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789& ";this.encodeBlocksSize=3;this.decodeBlocksSize=4;this.getAlphaSubStr=function(posArray){output="";for(var i in posArray)output+=this.base64Alpha[posArray[i]];return output}}Base64.prototype=new Algorithm;
Base64.prototype.encode=function(inputText){var output="";if(typeof inputText==="string"){var input=CryptoUtils.fixStringLength(inputText,this.encodeBlocksSize);var stringBlocksIterator=new StringBlocksIterator;stringBlocksIterator.init(input,this.encodeBlocksSize);var subdata=null;while(subdata=stringBlocksIterator.current()){var x=subdata.charCodeAt(0);var y=subdata.charCodeAt(1);var z=subdata.charCodeAt(2);CryptoConsole.logArrayAsBin([x,y,z],"base64.encode.input");this.sendCallback(this.onBeforeIteration);
var _x=x>>2;var _y=(x&3)<<4|y>>4;var _z=(y&15)<<2|z>>6;var _k=z&63;CryptoConsole.logArrayAsBin([_x,_y,_z,_k],"base64.decode.output");this.sendCallback(this.onAfterIteration);output+=this.getAlphaSubStr([_x,_y,_z,_k]);stringBlocksIterator.next()}}return output};
Base64.prototype.decode=function(inputText){var output="";if(typeof inputText==="string"){input=CryptoUtils.fixStringLength(inputText,this.decodeBlocksSize);stringBlocksIterator=new StringBlocksIterator;stringBlocksIterator.init(input,this.decodeBlocksSize);var subdata=null;while(subdata=stringBlocksIterator.current()){var x=this.base64Alpha.indexOf(subdata[0]);var y=this.base64Alpha.indexOf(subdata[1]);var z=this.base64Alpha.indexOf(subdata[2]);var k=this.base64Alpha.indexOf(subdata[3]);CryptoConsole.logArrayAsBin(new Array(x,
y,z,k),"base64.decode.input");this.sendCallback(this.onBeforeIteration);var _x=x<<2|y>>4;var _y=y<<4|z>>2;var _z=z<<6|k;_x=_x<<24;_x=_x>>24;_y=_y<<24;_y=_y>>24;_z=_z<<24;_z=_z>>24;CryptoConsole.logArrayAsBin(new Array(_x,_y,_z),"base64.decode.output");this.sendCallback(this.onAfterIteration);output+=String.fromCharCode(_x,_y,_z);stringBlocksIterator.next()}}return CryptoUtils.trim(output)};function Xor(){Algorithm.call()}Xor.prototype=new Algorithm;
Xor.prototype.encode=function(inputText,key){var outputText="";if(typeof inputText==="string"){inputIterator=new StringBlocksIterator;inputIterator.init(inputText,this.encodeBlocksSize);keyIterator=new StringBlocksIterator;keyIterator.init(key,this.encodeBlocksSize);var subdata=null;while(subdata=inputIterator.current()){var x=subdata.charCodeAt(0);if(keyIterator.current()===null)keyIterator.reset();var y=keyIterator.current().charCodeAt(0);var result=x^y;outputText+=String.fromCharCode(result);CryptoConsole.logArrayAsBin([x,
y,result],"input, output, result");this.sendCallback(this.onAfterIteration);inputIterator.next();keyIterator.next()}}return outputText};
